# === Canonical host + HTTPS (antes de todo) ===
RewriteEngine On

# Excepciones (Let's Encrypt, assets opcional)
RewriteCond %{REQUEST_URI} !^/\.well-known/acme-challenge/
RewriteCond %{REQUEST_URI} !^/login/manifest\.webmanifest$
RewriteCond %{REQUEST_URI} !^/login/service-worker\.js$

# Forzar host
RewriteCond %{HTTP_HOST} !^kasu\.com\.mx$ [NC]
RewriteRule ^ https://kasu.com.mx%{REQUEST_URI} [R=308,L]

# Forzar HTTPS
RewriteCond %{HTTPS} !=on
RewriteRule ^ https://kasu.com.mx%{REQUEST_URI} [R=308,L]

# === Tus reglas existentes ===
# URLs sin .php
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^(.+)$ $1.php [L]

# Error 404 personalizado
ErrorDocument 404 /error.php

# Compresión
<IfModule mod_deflate.c>
  SetOutputFilter DEFLATE
  AddOutputFilterByType DEFLATE text/html text/plain text/xml text/css application/javascript application/x-javascript
  AddOutputFilterByType DEFLATE image/png image/gif image/jpeg
</IfModule>

# Cache 30 días
<IfModule mod_expires.c>
  ExpiresActive On
  ExpiresByType image/* "access plus 30 days"
  ExpiresByType text/css "access plus 30 days"
</IfModule>
